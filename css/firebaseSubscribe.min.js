function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).firebase=t()}(this,function(){"use strict";!function(e){if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,s="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),r="FormData"in e,o="ArrayBuffer"in e;if(o)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&-1<i.indexOf(Object.prototype.toString.call(e))};d.prototype.append=function(e,t){e=h(e),t=l(t);var n=this.map[e];this.map[e]=n?n+","+t:t},d.prototype.delete=function(e){delete this.map[h(e)]},d.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},d.prototype.set=function(e,t){this.map[h(e)]=l(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),p(n)},d.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),p(t)},d.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),p(n)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},m.call(w.prototype),m.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},k.error=function(){var e=new k(null,{status:0,statusText:""});return e.type="error",e};var f=[301,302,303,307,308];k.redirect=function(e,t){if(-1===f.indexOf(t))throw new RangeError("Invalid status code");return new k(null,{status:t,headers:{location:e}})},e.Headers=d,e.Request=w,e.Response=k,e.fetch=function(n,o){return new Promise(function(r,e){var t=new w(n,o),i=new XMLHttpRequest;i.onload=function(){var e,o,t={status:i.status,statusText:i.statusText,headers:(e=i.getAllResponseHeaders()||"",o=new d,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),n=t.shift().trim();if(n){var r=t.join(":").trim();o.append(n,r)}}),o)};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var n="response"in i?i.response:i.responseText;r(new k(n,t))},i.onerror=function(){e(new TypeError("Network request failed"))},i.ontimeout=function(){e(new TypeError("Network request failed"))},i.open(t.method,t.url,!0),"include"===t.credentials?i.withCredentials=!0:"omit"===t.credentials&&(i.withCredentials=!1),"responseType"in i&&s&&(i.responseType="blob"),t.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===t._bodyInit?null:t._bodyInit)})},e.fetch.polyfill=!0}function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function p(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function d(t){this.map={},t instanceof d?t.forEach(function(e,t){this.append(t,e)},this):Array.isArray(t)?t.forEach(function(e){this.append(e[0],e[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function y(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function b(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function v(e){var t=new FileReader,n=b(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(s&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(r&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(o&&s&&a(e))this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!o||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=g(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var e=y(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var e,t,n,r=y(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,n=b(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function w(e,t){var n,r,o=(t=t||{}).body;if(e instanceof w){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=(r=(n=t.method||this.method||"GET").toUpperCase(),-1<u.indexOf(r)?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function _(e){var o=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),n=t.shift().replace(/\+/g," "),r=t.join("=").replace(/\+/g," ");o.append(decodeURIComponent(n),decodeURIComponent(r))}}),o}function k(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:void 0);var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t){return e(t={exports:{}},t.exports),t.exports}function n(t){var n=this.constructor;return this.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){return n.reject(e)})})}var r=setTimeout;function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(e,this)}function s(n,r){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn(function(){var e=1===n._state?r.onFulfilled:r.onRejected;if(null!==e){var t;try{t=e(n._value)}catch(e){return void c(r.promise,e)}a(r.promise,t)}else(1===n._state?a:c)(r.promise,n._value)})):n._deferreds.push(r)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==_typeof(t)||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void u(e);if("function"==typeof n)return void h((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,u(e)}catch(t){c(e,t)}var r,o}function c(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)s(e,e._deferreds[t]);e._deferreds=null}function f(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function h(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,c(t,e))})}catch(e){if(n)return;n=!0,c(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return s(this,new f(e,t,n)),n},i.prototype.finally=n,i.all=function(t){return new i(function(r,o){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return r([]);var s=i.length;function a(t,e){try{if(e&&("object"==_typeof(e)||"function"==typeof e)){var n=e.then;if("function"==typeof n)return void n.call(e,function(e){a(t,e)},o)}i[t]=e,0==--s&&r(i)}catch(e){o(e)}}for(var e=0;e<i.length;e++)a(e,i[e])})},i.resolve=function(t){return t&&"object"==_typeof(t)&&t.constructor===i?t:new i(function(e){e(t)})},i.reject=function(n){return new i(function(e,t){t(n)})},i.race=function(o){return new i(function(e,t){for(var n=0,r=o.length;n<r;n++)o[n].then(e,t)})},i._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){r(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var l=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}();"Promise"in l?l.Promise.prototype.finally||(l.Promise.prototype.finally=n):l.Promise=i;function p(e){if(!T(e))throw TypeError(e+" is not an object!");return e}function d(e){try{return!!e()}catch(e){return!0}}function y(e){return E?P.createElement(e):{}}function b(e,t){if(!T(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!T(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!T(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!T(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}function k(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function v(e,t){return N.call(e,t)}function g(e){return"Symbol(".concat(void 0===e?"":e,")_",(++x+C).toString(36))}function m(r,o,e){if(function(){if("function"!=typeof r)throw TypeError(r+" is not a function!")}(),void 0===o)return r;switch(e){case 1:return function(e){return r.call(o,e)};case 2:return function(e,t){return r.call(o,e,t)};case 3:return function(e,t,n){return r.call(o,e,t,n)}}return function(){return r.apply(o,arguments)}}function w(e,t,n){var r,o,i,s,a=e&w.F,c=e&w.G,u=e&w.P,f=e&w.B,h=c?_:e&w.S?_[t]||(_[t]={}):(_[t]||{})[L],l=c?S:S[t]||(S[t]={}),p=l[L]||(l[L]={});for(r in c&&(n=t),n)i=((o=!a&&h&&void 0!==h[r])?h:n)[r],s=f&&o?m(i,_):u&&"function"==typeof i?m(Function.call,i):i,h&&R(h,r,i,e&w.U),l[r]!=i&&I(l,r,s),u&&p[r]!=i&&(p[r]=i)}var _=t(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),S=t(function(e){var t=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=t)}),T=(S.version,function(e){return"object"==_typeof(e)?null!==e:"function"==typeof e}),O=!d(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),P=_.document,E=T(P)&&T(P.createElement),A=!O&&!d(function(){return 7!=Object.defineProperty(y("div"),"a",{get:function(){return 7}}).a}),j=Object.defineProperty,D={f:O?Object.defineProperty:function(e,t,n){if(p(e),t=b(t,!0),p(n),A)try{return j(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},I=O?function(e,t,n){return D.f(e,t,k(1,n))}:function(e,t,n){return e[t]=n,e},N={}.hasOwnProperty,x=0,C=Math.random(),M=t(function(e){var t="__core-js_shared__",n=_[t]||(_[t]={});(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:S.version,mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}),F=M("native-function-to-string",Function.toString),R=t(function(e){var i=g("src"),t="toString",s=(""+F).split(t);S.inspectSource=function(e){return F.call(e)},(e.exports=function(e,t,n,r){var o="function"==typeof n;o&&(v(n,"name")||I(n,"name",t)),e[t]!==n&&(o&&(v(n,i)||I(n,i,e[t]?""+e[t]:s.join(String(t)))),e===_?e[t]=n:r?e[t]?e[t]=n:I(e,t,n):(delete e[t],I(e,t,n)))})(Function.prototype,t,function(){return"function"==typeof this&&this[i]||F.call(this)})}),L="prototype";_.core=S,w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128;function U(e){return q.call(e).slice(8,-1)}function W(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}function K(e){return Object(W(e))}function B(e){return isNaN(e=+e)?0:(0<e?J:Y)(e)}function V(e){return 0<e?Q(B(e),9007199254740991):0}function z(e,t){return X(n=e)&&("function"!=typeof(r=n.constructor)||r!==Array&&!X(r.prototype)||(r=void 0),T(r)&&null===(r=r[ee])&&(r=void 0)),new(void 0===r?Array:r)(t);var n,r}function G(h,e){var l=1==h,p=2==h,d=3==h,y=4==h,b=6==h,v=5==h||b,g=e||z;return function(e,t,n){for(var r,o,i=K(e),s=$(i),a=m(t,n,3),c=V(s.length),u=0,f=l?g(e,c):p?g(e,0):void 0;u<c;u++)if((v||u in s)&&(o=a(r=s[u],u,i),h))if(l)f[u]=o;else if(o)switch(h){case 3:return!0;case 5:return r;case 6:return u;case 2:f.push(r)}else if(y)return!1;return b?-1:d||y?y:f}}var H=w,q={}.toString,$=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==U(e)?e.split(""):Object(e)},Y=Math.ceil,J=Math.floor,Q=Math.min,X=Array.isArray||function(e){return"Array"==U(e)},Z=t(function(e){var t=M("wks"),n=_.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:g)("Symbol."+e))}).store=t}),ee=Z("species"),te=Z("unscopables"),ne=Array.prototype;null==ne[te]&&I(ne,te,{});function re(e){ne[te][e]=!0}var oe=G(5),ie="find",se=!0;ie in[]&&Array(1)[ie](function(){se=!1}),H(H.P+H.F*se,"Array",{find:function(e,t){return oe(this,e,1<arguments.length?t:void 0)}}),re(ie),S.Array.find;var ae=G(6),ce="findIndex",ue=!0;ce in[]&&Array(1)[ce](function(){ue=!1}),H(H.P+H.F*ue,"Array",{findIndex:function(e,t){return ae(this,e,1<arguments.length?t:void 0)}}),re(ce),S.Array.findIndex;function fe(e){return $(W(e))}function he(e){return ye[e]||(ye[e]=g(e))}function le(e,t){var n,r=fe(e),o=0,i=[];for(n in r)n!=ve&&v(r,n)&&i.push(n);for(;t.length>o;)v(r,n=t[o++])&&(~be(i,n)||i.push(n));return i}var pe=Math.max,de=Math.min,ye=M("keys"),be=(!1,function(e,t,n){var r,o,i=fe(e),s=V(i.length),a=(o=s,(r=B(r=n))<0?pe(r+o,0):de(r,o));for(0;a<s;a++)if(a in i&&i[a]===t)return a||0;return-1}),ve=he("IE_PROTO"),ge="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),me=Object.keys||function(e){return le(e,ge)},we={f:Object.getOwnPropertySymbols},_e={f:{}.propertyIsEnumerable},ke=Object.assign,Se=!ke||d(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=ke({},e)[n]||Object.keys(ke({},t)).join("")!=r})?function(e,t){for(var n=K(e),r=arguments.length,o=1,i=we.f,s=_e.f;o<r;)for(var a,c=$(arguments[o++]),u=i?me(c).concat(i(c)):me(c),f=u.length,h=0;h<f;)s.call(c,a=u[h++])&&(n[a]=c[a]);return n}:ke;H(H.S+H.F,"Object",{assign:Se}),S.Object.assign;var Te=Z("match"),Oe=Z("match"),Pe="startsWith",Ee=""[Pe];H(H.P+H.F*function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[Oe]=!1,!"/./"[t](n)}catch(e){}}return!0}(Pe),"String",{startsWith:function(e,t){var n=function(e,t,n){if(T(r=t)&&(void 0!==(o=r[Te])?o:"RegExp"==U(r)))throw TypeError("String#"+n+" doesn't accept regex!");var r,o;return String(W(e))}(this,e,Pe),r=V(Math.min(1<arguments.length?t:void 0,n.length)),o=String(e);return Ee?Ee.call(n,o,r):n.slice(r,r+o.length)===o}}),S.String.startsWith,H(H.P,"String",{repeat:function(e){var t=String(W(this)),n="",r=B(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;0<r;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}}),S.String.repeat;function Ae(e,t,n){e&&!v(e=n?e:e.prototype,We)&&Ue(e,We,{configurable:!0,value:t})}function je(e){var t=S.Symbol||(S.Symbol=_.Symbol||{});"_"==e.charAt(0)||e in t||Be(t,e,{value:Ke.f(e)})}function De(){}function Ie(e){var t=bt[e]=Ye(ct[ht]);return t._k=e,t}function Ne(e,t,n){return e===gt&&Ne(vt,t,n),p(e),t=b(t,!0),p(n),v(bt,t)?(n.enumerable?(v(e,lt)&&e[lt][t]&&(e[lt][t]=!1),n=Ye(n,{enumerable:k(0,!1)})):(v(e,lt)||st(e,lt,k(1,{})),e[lt][t]=!0),kt(e,t,n)):st(e,t,n)}function xe(e,t){p(e);for(var n,r=function(e){var t=me(e),n=we.f;if(n)for(var r,o=n(e),i=_e.f,s=0;o.length>s;)i.call(e,r=o[s++])&&t.push(r);return t}(t=fe(t)),o=0,i=r.length;o<i;)Ne(e,n=r[o++],t[n]);return e}function Ce(e){var t=dt.call(this,e=b(e,!0));return!(this===gt&&v(bt,e)&&!v(vt,e))&&(!(t||!v(this,e)||!v(bt,e)||v(this,lt)&&this[lt][e])||t)}function Me(e,t){if(e=fe(e),t=b(t,!0),e!==gt||!v(bt,t)||v(vt,t)){var n=it(e,t);return!n||!v(bt,t)||v(e,lt)&&e[lt][t]||(n.enumerable=!0),n}}function Fe(e){for(var t,n=at(fe(e)),r=[],o=0;n.length>o;)v(bt,t=n[o++])||t==lt||t==ot||r.push(t);return r}function Re(e){for(var t,n=e===gt,r=at(n?vt:fe(e)),o=[],i=0;r.length>i;)!v(bt,t=r[i++])||n&&!v(gt,t)||o.push(bt[t]);return o}var Le=t(function(e){function n(e){t(e,r,{value:{i:"O"+ ++o,w:{}}})}var r=g("meta"),t=D.f,o=0,i=Object.isExtensible||function(){return!0},s=!d(function(){return i(Object.preventExtensions({}))}),a=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!T(e))return"symbol"==_typeof(e)?e:("string"==typeof e?"S":"P")+e;if(!v(e,r)){if(!i(e))return"F";if(!t)return"E";n(e)}return e[r].i},getWeak:function(e,t){if(!v(e,r)){if(!i(e))return!0;if(!t)return!1;n(e)}return e[r].w},onFreeze:function(e){return s&&a.NEED&&i(e)&&!v(e,r)&&n(e),e}}}),Ue=(Le.KEY,Le.NEED,Le.fastKey,Le.getWeak,Le.onFreeze,D.f),We=Z("toStringTag"),Ke={f:Z},Be=D.f,Ve=O?Object.defineProperties:function(e,t){p(e);for(var n,r=me(t),o=r.length,i=0;i<o;)D.f(e,n=r[i++],t[n]);return e},ze=_.document,Ge=ze&&ze.documentElement,He=he("IE_PROTO"),qe="prototype",$e=function(){var e,t=y("iframe"),n=ge.length;for(t.style.display="none",Ge.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),$e=e.F;n--;)delete $e[qe][ge[n]];return $e()},Ye=Object.create||function(e,t){var n;return null!==e?(De[qe]=p(e),n=new De,De[qe]=null,n[He]=e):n=$e(),void 0===t?n:Ve(n,t)},Je=ge.concat("length","prototype"),Qe={f:Object.getOwnPropertyNames||function(e){return le(e,Je)}},Xe=Qe.f,Ze={}.toString,et="object"==("undefined"==typeof window?"undefined":_typeof(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],tt={f:function(e){return et&&"[object Window]"==Ze.call(e)?function(e){try{return Xe(e)}catch(e){return et.slice()}}(e):Xe(fe(e))}},nt=Object.getOwnPropertyDescriptor,rt={f:O?nt:function(e,t){if(e=fe(e),t=b(t,!0),A)try{return nt(e,t)}catch(e){}if(v(e,t))return k(!_e.f.call(e,t),e[t])}},ot=Le.KEY,it=rt.f,st=D.f,at=tt.f,ct=_.Symbol,ut=_.JSON,ft=ut&&ut.stringify,ht="prototype",lt=Z("_hidden"),pt=Z("toPrimitive"),dt={}.propertyIsEnumerable,yt=M("symbol-registry"),bt=M("symbols"),vt=M("op-symbols"),gt=Object[ht],mt="function"==typeof ct,wt=_.QObject,_t=!wt||!wt[ht]||!wt[ht].findChild,kt=O&&d(function(){return 7!=Ye(st({},"a",{get:function(){return st(this,"a",{value:7}).a}})).a})?function(e,t,n){var r=it(gt,t);r&&delete gt[t],st(e,t,n),r&&e!==gt&&st(gt,t,r)}:st,St=mt&&"symbol"==_typeof(ct.iterator)?function(e){return"symbol"==_typeof(e)}:function(e){return e instanceof ct};mt||(R((ct=function(e){if(this instanceof ct)throw TypeError("Symbol is not a constructor!");var n=g(0<arguments.length?e:void 0);return O&&_t&&kt(gt,n,{configurable:!0,set:function e(t){this===gt&&e.call(vt,t),v(this,lt)&&v(this[lt],n)&&(this[lt][n]=!1),kt(this,n,k(1,t))}}),Ie(n)})[ht],"toString",function(){return this._k}),rt.f=Me,D.f=Ne,Qe.f=tt.f=Fe,_e.f=Ce,we.f=Re,O&&R(gt,"propertyIsEnumerable",Ce,!0),Ke.f=function(e){return Ie(Z(e))}),H(H.G+H.W+H.F*!mt,{Symbol:ct});for(var Tt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Ot=0;Tt.length>Ot;)Z(Tt[Ot++]);for(var Pt=me(Z.store),Et=0;Pt.length>Et;)je(Pt[Et++]);H(H.S+H.F*!mt,"Symbol",{for:function(e){return v(yt,e+="")?yt[e]:yt[e]=ct(e)},keyFor:function(e){if(!St(e))throw TypeError(e+" is not a symbol!");for(var t in yt)if(yt[t]===e)return t},useSetter:function(){_t=!0},useSimple:function(){_t=!1}}),H(H.S+H.F*!mt,"Object",{create:function(e,t){return void 0===t?Ye(e):xe(Ye(e),t)},defineProperty:Ne,defineProperties:xe,getOwnPropertyDescriptor:Me,getOwnPropertyNames:Fe,getOwnPropertySymbols:Re}),ut&&H(H.S+H.F*(!mt||d(function(){var e=ct();return"[null]"!=ft([e])||"{}"!=ft({a:e})||"{}"!=ft(Object(e))})),"JSON",{stringify:function(e){for(var t,n,r=[e],o=1;o<arguments.length;)r.push(arguments[o++]);if(n=t=r[1],(T(t)||void 0!==e)&&!St(e))return X(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!St(t))return t}),r[1]=t,ft.apply(ut,r)}}),ct[ht][pt]||I(ct[ht],pt,ct[ht].valueOf),Ae(ct,"Symbol"),Ae(Math,"Math",!0),Ae(_.JSON,"JSON",!0);var At=Z("toStringTag"),jt="Arguments"==U(function(){return arguments}()),Dt={};Dt[Z("toStringTag")]="z",Dt+""!="[object z]"&&R(Object.prototype,"toString",function(){return"[object "+(void 0===this?"Undefined":null===this?"Null":"string"==typeof(t=function(e,t){try{return e[t]}catch(e){}}(e=Object(this),At))?t:jt?U(e):"Object"==(n=U(e))&&"function"==typeof e.callee?"Arguments":n)+"]";var e,t,n},!0),je("asyncIterator"),je("observable"),S.Symbol;var It={},Nt={};I(Nt,Z("iterator"),function(){return this});function xt(){return this}function Ct(e,t,n,r,o,i,s){var a,c,u;function f(e){if(!Ut&&e in v)return v[e];switch(e){case"keys":case Wt:return function(){return new n(this,e)}}return function(){return new n(this,e)}}c=t,u=r,(a=n).prototype=Ye(Nt,{next:k(1,u)}),Ae(a,c+" Iterator");var h,l,p,d=t+" Iterator",y=o==Wt,b=!1,v=e.prototype,g=v[Lt]||v["@@iterator"]||o&&v[o],m=g||f(o),w=o?y?f("entries"):m:void 0,_="Array"==t&&v.entries||g;if(_&&(p=Rt(_.call(new e)))!==Object.prototype&&p.next&&(Ae(p,d,!0),"function"!=typeof p[Lt]&&I(p,Lt,xt)),y&&g&&g.name!==Wt&&(b=!0,m=function(){return g.call(this)}),!Ut&&!b&&v[Lt]||I(v,Lt,m),It[t]=m,It[d]=xt,o)if(h={values:y?m:f(Wt),keys:i?m:f("keys"),entries:w},s)for(l in h)l in v||R(v,l,h[l]);else H(H.P+H.F*(Ut||b),t,h);return h}var Mt=he("IE_PROTO"),Ft=Object.prototype,Rt=Object.getPrototypeOf||function(e){return e=K(e),v(e,Mt)?e[Mt]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Ft:null},Lt=Z("iterator"),Ut=!([].keys&&"next"in[].keys()),Wt="values",Kt=(!0,function(e,t){var n,r,o=String(W(e)),i=B(t),s=o.length;return i<0||s<=i?"":(n=o.charCodeAt(i))<55296||56319<n||i+1===s||(r=o.charCodeAt(i+1))<56320||57343<r?o.charAt(i):o.slice(i,i+2)});Ct(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=Kt(t,n),this._i+=e.length,{value:e,done:!1})});function Bt(e,t){return{value:t,done:!!e}}var Vt=Ct(Array,"Array",function(e,t){this._t=fe(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,Bt(1)):Bt(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values");It.Arguments=It.Array,re("keys"),re("values"),re("entries");for(var zt=Z("iterator"),Gt=Z("toStringTag"),Ht=It.Array,qt={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},$t=me(qt),Yt=0;Yt<$t.length;Yt++){var Jt,Qt=$t[Yt],Xt=qt[Qt],Zt=_[Qt],en=Zt&&Zt.prototype;if(en&&(en[zt]||I(en,zt,Ht),en[Gt]||I(en,Gt,Qt),It[Qt]=Ht,Xt))for(Jt in Vt)en[Jt]||R(en,Jt,Vt[Jt],!0)}Ke.f("iterator");var tn=function(e,t){return(tn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function nn(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=nn(e[n],t[n]));return e}function rn(e,t,n){e[t]=n}function on(e,t){if(this.code=e,this.message=t,an)an(this,hn.prototype.create);else try{throw Error.apply(this,arguments)}catch(e){this.name=sn,Object.defineProperty(this,"stack",{get:function(){return e.stack}})}}var sn="FirebaseError",an=Error.captureStackTrace;((on.prototype=Object.create(Error.prototype)).constructor=on).prototype.name=sn;var cn,un,fn,hn=(ln.prototype.create=function(e,r){void 0===r&&(r={});var t,n=this.errors[e],o=this.service+"/"+e;t=void 0===n?"Error":n.replace(this.pattern,function(e,t){var n=r[t];return void 0!==n?n.toString():"<"+t+"?>"}),t=this.serviceName+": "+t+" ("+o+").";var i=new on(o,t);for(var s in r)r.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(i[s]=r[s]);return i},ln);function ln(e,t,n){this.service=e,this.serviceName=t,this.errors=n,this.pattern=/\{\$([^}]+)}/g}function pn(){var e=cn.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var t=1;t<e.blockSize;++t)e.pad_[t]=0;return e.reset(),e}function dn(){this.constructor=un}function yn(e,t){var n=new bn(e,t);return n.subscribe.bind(n)}tn(un=pn,fn=cn=function(){this.blockSize=-1}),un.prototype=null===fn?Object.create(fn):(dn.prototype=fn.prototype,new dn),pn.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},pn.prototype.compress_=function(e,t){t=t||0;var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var o=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(o<<1|o>>>31)}var i,s,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],f=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)s=r<40?r<20?(i=f^c&(u^f),1518500249):(i=c^u^f,1859775393):r<60?(i=c&u|f&(c|u),2400959708):(i=c^u^f,3395469782),o=(a<<5|a>>>27)+i+h+s+n[r]&4294967295,h=f,f=u,u=4294967295&(c<<30|c>>>2),c=a,a=o;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},pn.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,o=this.buf_,i=this.inbuf_;r<t;){if(0==i)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(o[i]=e.charCodeAt(r),++r,++i==this.blockSize){this.compress_(o),i=0;break}}else for(;r<t;)if(o[i]=e[r],++r,++i==this.blockSize){this.compress_(o),i=0;break}}this.inbuf_=i,this.total_+=t}},pn.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var o=24;0<=o;o-=8)e[r]=this.chain_[n]>>o&255,++r;return e};var bn=(vn.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},vn.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},vn.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},vn.prototype.subscribe=function(e,t,n){var r,o=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e){if("object"!=_typeof(e)||null===e)return!1;for(var t=0,n=["next","error","complete"];t<n.length;t++){var r=n[t];if(r in e&&"function"==typeof e[r])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=gn),void 0===r.error&&(r.error=gn),void 0===r.complete&&(r.complete=gn);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?r.error(o.finalError):r.complete()}catch(e){}}),this.observers.push(r),i},vn.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},vn.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},vn.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},vn.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},vn);function vn(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}function gn(){}function mn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var wn="[DEFAULT]",_n=[],kn=(Object.defineProperty(Sn.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed_(),this._automaticDataCollectionEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(Sn.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(Sn.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),Sn.prototype.delete=function(){var r=this;return new Promise(function(e){r.checkDestroyed_(),e()}).then(function(){r.firebase_.INTERNAL.removeApp(r.name_);var n=[];return Object.keys(r.services_).forEach(function(t){Object.keys(r.services_[t]).forEach(function(e){n.push(r.services_[t][e])})}),Promise.all(n.map(function(e){return e.INTERNAL.delete()}))}).then(function(){r.isDeleted_=!0,r.services_={}})},Sn.prototype._getService=function(e,t){if(void 0===t&&(t=wn),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n=t!==wn?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]},Sn.prototype.extendApp=function(e){var t=this;nn(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(_n.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),_n=[])},Sn.prototype.checkDestroyed_=function(){this.isDeleted_&&Tn("app-deleted",{name:this.name_})},Sn);function Sn(e,t,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled||!1,this.options_=nn(void 0,e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){_n.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(t){_n=_n.filter(function(e){return e!==t})}}}function Tn(e,t){throw On.create(e,t)}kn.prototype.name&&kn.prototype.options||kn.prototype.delete||console.log("dc");var On=new hn("app","Firebase",{"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."}),Pn=!1;try{Pn="[object process]"===Object.prototype.toString.call(global.process)}catch(e){}return Pn&&console.warn('\nWarning: This is a browser-targeted Firebase bundle but it appears it is being\nrun in a Node environment.  If running in a Node environment, make sure you\nare using the bundle specified by the "main" field in package.json.\n\nIf you are using Webpack, you can specify "main" as the first item in\n"resolve.mainFields":\nhttps://webpack.js.org/configuration/resolve/#resolvemainfields\n\nIf using Rollup, use the rollup-plugin-node-resolve plugin and set "module"\nto false and "main" to true:\nhttps://github.com/rollup/rollup-plugin-node-resolve\n'),function e(){var i={},s={},a={},c={__esModule:!0,initializeApp:function(e,t){void 0===t&&(t={}),"object"==_typeof(t)&&null!==t||(t={name:t});var n=t;void 0===n.name&&(n.name=wn);var r=n.name;"string"==typeof r&&r||Tn("bad-app-name",{name:r+""}),mn(i,r)&&Tn("duplicate-app",{name:r});var o=new kn(e,n,c);return h(i[r]=o,"create"),o},app:u,apps:null,Promise:Promise,SDK_VERSION:"5.9.0",INTERNAL:{registerService:function(n,e,t,r,o){s[n]&&Tn("duplicate-service",{name:n}),s[n]=e,r&&(a[n]=r,f().forEach(function(e){r("create",e)}));function i(e){return void 0===e&&(e=u()),"function"!=typeof e[n]&&Tn("invalid-app-argument",{name:n}),e[n]()}return void 0!==t&&nn(i,t),c[n]=i,kn.prototype[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,n).apply(this,o?e:[])},i},createFirebaseNamespace:e,extendNamespace:function(e){nn(c,e)},createSubscribe:yn,ErrorFactory:hn,removeApp:function(e){h(i[e],"delete"),delete i[e]},factories:s,useAsService:o,Promise:Promise,deepExtend:nn}};function u(e){return mn(i,e=e||wn)||Tn("no-app",{name:e}),i[e]}function f(){return Object.keys(i).map(function(e){return i[e]})}function h(n,r){Object.keys(s).forEach(function(e){var t=o(n,e);null!==t&&a[t]&&a[t](r,n)})}function o(e,t){if("serverAuth"===t)return null;var n=t;return e.options,n}return rn(c,"default",c),Object.defineProperty(c,"apps",{get:f}),rn(u,"App",kn),c}()}),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],t):t((e=e||self).firebase)}(this,function(Ce){"use strict";try{(function(){Ce=Ce&&Ce.hasOwnProperty("default")?Ce.default:Ce;var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function e(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function d(i,s,a,c){return new(a=a||Promise)(function(e,t){function n(e){try{o(c.next(e))}catch(e){t(e)}}function r(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(n,r)}o((c=c.apply(i,s||[])).next())})}function y(n,r){var o,i,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(n,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function n(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function a(e,t){if(this.code=e,this.message=t,s)s(this,u.prototype.create);else try{throw Error.apply(this,arguments)}catch(e){this.name=o,Object.defineProperty(this,"stack",{get:function(){return e.stack}})}}var o="FirebaseError",s=Error.captureStackTrace;((a.prototype=Object.create(Error.prototype)).constructor=a).prototype.name=o;var c,u=(t.prototype.create=function(e,r){void 0===r&&(r={});var t,n=this.errors[e],o=this.service+"/"+e;t=void 0===n?"Error":n.replace(this.pattern,function(e,t){var n=r[t];return void 0!==n?n.toString():"<"+t+"?>"}),t=this.serviceName+": "+t+" ("+o+").";var i=new a(o,t);for(var s in r)r.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(i[s]=r[s]);return i},t);function t(e,t,n){this.service=e,this.serviceName=t,this.errors=n,this.pattern=/\{\$([^}]+)}/g}function f(){var e=c.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var t=1;t<e.blockSize;++t)e.pad_[t]=0;return e.reset(),e}function h(e,t){var n=new p(e,t);return n.subscribe.bind(n)}e(f,c=function(){this.blockSize=-1}),f.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},f.prototype.compress_=function(e,t){t=t||0;var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var o=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(o<<1|o>>>31)}var i,s,a=this.chain_[0],c=this.chain_[1],u=this.chain_[2],f=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++)s=r<40?r<20?(i=f^c&(u^f),1518500249):(i=c^u^f,1859775393):r<60?(i=c&u|f&(c|u),2400959708):(i=c^u^f,3395469782),o=(a<<5|a>>>27)+i+h+s+n[r]&4294967295,h=f,f=u,u=4294967295&(c<<30|c>>>2),c=a,a=o;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},f.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,o=this.buf_,i=this.inbuf_;r<t;){if(0==i)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(o[i]=e.charCodeAt(r),++r,++i==this.blockSize){this.compress_(o),i=0;break}}else for(;r<t;)if(o[i]=e[r],++r,++i==this.blockSize){this.compress_(o),i=0;break}}this.inbuf_=i,this.total_+=t}},f.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var o=24;0<=o;o-=8)e[r]=this.chain_[n]>>o&255,++r;return e};var l,p=(b.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},b.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},b.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},b.prototype.subscribe=function(e,t,n){var r,o=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e){if("object"!=_typeof(e)||null===e)return!1;for(var t=0,n=["next","error","complete"];t<n.length;t++){var r=n[t];if(r in e&&"function"==typeof e[r])return!0}return!1}(e)?e:{next:e,error:t,complete:n}).next&&(r.next=v),void 0===r.error&&(r.error=v),void 0===r.complete&&(r.complete=v);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?r.error(o.finalError):r.complete()}catch(e){}}),this.observers.push(r),i},b.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},b.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},b.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},b.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},b);function b(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}function v(){}var g,m,w,_,k="only-available-in-window",S="only-available-in-sw",T="bad-sender-id",O="incorrect-gcm-sender-id",P="permission-default",E="permission-blocked",A="unsupported-browser",j="notifications-blocked",D="failed-serviceworker-registration",I="sw-registration-expected",N="sw-reg-redundant",x="token-subscribe-failed",C="token-subscribe-no-token",M="token-subscribe-no-push-set",F="token-unsubscribe-failed",R="token-update-failed",L="token-update-no-token",U="use-sw-before-get-token",W="invalid-delete-token",K="delete-token-not-found",B="delete-scope-not-found",V="bg-handler-function-expected",z="no-window-client-to-msg",G="unable-to-resubscribe",H="no-sw-in-reg",q="bad-scope",$="bad-vapid-key",Y="bad-subscription",J="bad-token",Q="bad-push-set",X="invalid-public-vapid-key",Z="public-vapid-key-decryption-failed",ee=((l={})[k]="This method is available in a Window context.",l[S]="This method is available in a service worker context.",l["should-be-overriden"]="This method should be overriden by extended classes.",l[T]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",l[P]="The required permissions were not granted and dismissed instead.",l[E]="The required permissions were not granted and blocked instead.",l[A]="This browser doesn't support the API's required to use the firebase SDK.",l[j]="Notifications have been blocked.",l[D]="We are unable to register the default service worker. {$browserErrorMessage}",l[I]="A service worker registration was the expected input.",l["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",l["invalid-saved-token"]="Unable to access details of the saved token.",l[N]="The service worker being used for push was made redundant.",l[x]="A problem occured while subscribing the user to FCM: {$message}",l[C]="FCM returned no token when subscribing the user to push.",l[M]="FCM returned an invalid response when getting an FCM token.",l[F]="A problem occured while unsubscribing the user from FCM: {$message}",l[R]="A problem occured while updating the user from FCM: {$message}",l[L]="FCM returned no token when updating the user to push.",l[U]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",l[W]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",l[K]="The deletion attempt for token could not be performed as the token was not found.",l[B]="The deletion attempt for service worker scope could not be performed as the scope was not found.",l[V]="The input to setBackgroundMessageHandler() must be a function.",l[z]="An attempt was made to message a non-existant window client.",l[G]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",l["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",l["failed-to-delete-token"]="Unable to delete the currently saved token.",l[H]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",l[O]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",l[q]="The service worker scope must be a string with at least one character.",l[$]="The public VAPID key is not a Uint8Array with 65 bytes.",l[Y]="The subscription must be a valid PushSubscription.",l[J]="The FCM Token used for storage / lookup was not a valid token string.",l[Q]="The FCM push set used for storage / lookup was not not a valid push set string.",l["failed-delete-vapid-key"]="The VAPID key could not be deleted.",l[X]="The public VAPID key must be a string.",l[Z]="The public VAPID key did not equal 65 bytes when decrypted.",l),te=new u("messaging","Messaging",ee),ne=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),re="https://fcm.googleapis.com";function oe(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),o=0;o<e.byteLength;o++)if(n.getUint8(o)!==r.getUint8(o))return!1;return!0}function ie(e){return function(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e}(t)))}(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}(m=g=g||{}).TYPE_OF_MSG="firebase-messaging-msg-type",m.DATA="firebase-messaging-msg-data",(_=w=w||{}).PUSH_MSG_RECEIVED="push-msg-received",_.NOTIFICATION_CLICKED="notification-clicked";var se=(ae.prototype.getToken=function(u,f,h){return d(this,void 0,void 0,function(){var t,n,r,o,i,s,a,c;return y(this,function(e){switch(e.label){case 0:t=ie(f.getKey("p256dh")),n=ie(f.getKey("auth")),r="authorized_entity="+u+"&endpoint="+f.endpoint+"&encryption_key="+t+"&encryption_auth="+n,oe(h.buffer,ne.buffer)||(o=ie(h),r+="&application_pub_key="+o),(i=new Headers).append("Content-Type","application/x-www-form-urlencoded"),s={method:"POST",headers:i,body:r},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(re+"/fcm/connect/subscribe",s)];case 2:return[4,e.sent().json()];case 3:return a=e.sent(),[3,5];case 4:throw e.sent(),te.create(x);case 5:if(a.error)throw c=a.error.message,te.create(x,{message:c});if(!a.token)throw te.create(C);if(!a.pushSet)throw te.create(M);return[2,{token:a.token,pushSet:a.pushSet}]}})})},ae.prototype.updateToken=function(u,f,h,l,p){return d(this,void 0,void 0,function(){var t,n,r,o,i,s,a,c;return y(this,function(e){switch(e.label){case 0:t=ie(l.getKey("p256dh")),n=ie(l.getKey("auth")),r="push_set="+h+"&token="+f+"&authorized_entity="+u+"&endpoint="+l.endpoint+"&encryption_key="+t+"&encryption_auth="+n,oe(p.buffer,ne.buffer)||(o=ie(p),r+="&application_pub_key="+o),(i=new Headers).append("Content-Type","application/x-www-form-urlencoded"),s={method:"POST",headers:i,body:r},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(re+"/fcm/connect/subscribe",s)];case 2:return[4,e.sent().json()];case 3:return a=e.sent(),[3,5];case 4:throw e.sent(),te.create(R);case 5:if(a.error)throw c=a.error.message,te.create(R,{message:c});if(!a.token)throw te.create(L);return[2,a.token]}})})},ae.prototype.deleteToken=function(s,a,c){return d(this,void 0,void 0,function(){var t,n,r,o,i;return y(this,function(e){switch(e.label){case 0:t="authorized_entity="+s+"&token="+a+"&pushSet="+c,(n=new Headers).append("Content-Type","application/x-www-form-urlencoded"),r={method:"POST",headers:n,body:t},e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(re+"/fcm/connect/unsubscribe",r)];case 2:return[4,e.sent().json()];case 3:if((o=e.sent()).error)throw i=o.error.message,te.create(F,{message:i});return[3,5];case 4:throw e.sent(),te.create(F);case 5:return[2]}})})},ae);function ae(){}function ce(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}var ue="undefined",fe="fcm_token_object_Store";var he=(le.prototype.get=function(t){return this.createTransaction(function(e){return e.get(t)})},le.prototype.getIndex=function(t,n){return this.createTransaction(function(e){return e.index(t).get(n)})},le.prototype.put=function(t){return this.createTransaction(function(e){return e.put(t)},"readwrite")},le.prototype.delete=function(t){return this.createTransaction(function(e){return e.delete(t)},"readwrite")},le.prototype.closeDatabase=function(){return d(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:e.sent().close(),this.dbPromise=null,e.label=2;case 2:return[2]}})})},le.prototype.createTransaction=function(s,a){return void 0===a&&(a="readonly"),d(this,void 0,void 0,function(){var t,r,o,i;return y(this,function(e){switch(e.label){case 0:return[4,this.getDb()];case 1:return t=e.sent(),r=t.transaction(this.objectStoreName,a),o=r.objectStore(this.objectStoreName),[4,(n=s(o),new Promise(function(e,t){n.onsuccess=function(){e(n.result)},n.onerror=function(){t(n.error)}}))];case 2:return i=e.sent(),[2,new Promise(function(e,t){r.oncomplete=function(){e(i)},r.onerror=function(){t(r.error)}})]}var n})})},le.prototype.getDb=function(){var r=this;return this.dbPromise||(this.dbPromise=new Promise(function(e,t){var n=indexedDB.open(r.dbName,r.dbVersion);n.onsuccess=function(){e(n.result)},n.onerror=function(){r.dbPromise=null,t(n.error)},n.onupgradeneeded=function(e){return r.onDbUpgrade(n,e)}})),this.dbPromise},le);function le(){this.dbPromise=null}var pe,de=(e(ye,pe=he),ye.prototype.onDbUpgrade=function(e,t){var n=e.result;switch(t.oldVersion){case 0:(r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"})).createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:!function(){var t=indexedDB.open(ue);t.onerror=function(e){},t.onsuccess=function(e){!function(n){if(n.objectStoreNames.contains(fe)){var e=n.transaction(fe).objectStore(fe),r=new se,o=e.openCursor();o.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},o.onsuccess=function(){var e=o.result;if(e){var t=e.value;r.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet),e.continue()}else n.close(),indexedDB.deleteDatabase(ue)}}}(t.result)}}();case 2:var r,o=(r=e.transaction.objectStore(this.objectStoreName)).openCursor();o.onsuccess=function(){var e=o.result;if(e){var t=e.value,n=i({},t);t.createTime||(n.createTime=Date.now()),"string"==typeof t.vapidKey&&(n.vapidKey=ce(t.vapidKey)),"string"==typeof t.auth&&(n.auth=ce(t.auth).buffer),"string"==typeof t.auth&&(n.p256dh=ce(t.p256dh).buffer),e.update(n),e.continue()}}}},ye.prototype.getTokenDetailsFromToken=function(t){return d(this,void 0,void 0,function(){return y(this,function(e){if(!t)throw te.create(J);return be({fcmToken:t}),[2,this.getIndex("fcmToken",t)]})})},ye.prototype.getTokenDetailsFromSWScope=function(t){return d(this,void 0,void 0,function(){return y(this,function(e){if(!t)throw te.create(q);return be({swScope:t}),[2,this.get(t)]})})},ye.prototype.saveTokenDetails=function(t){return d(this,void 0,void 0,function(){return y(this,function(e){if(!t.swScope)throw te.create(q);if(!t.vapidKey)throw te.create($);if(!t.endpoint||!t.auth||!t.p256dh)throw te.create(Y);if(!t.fcmSenderId)throw te.create(T);if(!t.fcmToken)throw te.create(J);if(!t.fcmPushSet)throw te.create(Q);return be(t),[2,this.put(t)]})})},ye.prototype.deleteToken=function(n){return d(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return"string"!=typeof n||0===n.length?[2,Promise.reject(te.create(W))]:[4,this.getTokenDetailsFromToken(n)];case 1:if(!(t=e.sent()))throw te.create(K);return[4,this.delete(t.swScope)];case 2:return e.sent(),[2,t]}})})},ye);function ye(){var e=null!==pe&&pe.apply(this,arguments)||this;return e.dbName="fcm_token_details_db",e.dbVersion=3,e.objectStoreName="fcm_token_object_Store",e}function be(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw te.create(J);if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw te.create(q);if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw te.create($);if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw te.create(Y);if(e.auth&&!(e.auth instanceof ArrayBuffer))throw te.create(Y);if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw te.create(Y);if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw te.create(T);if(e.fcmPushSet&&("string"!=typeof e.fcmPushSet||0===e.fcmPushSet.length))throw te.create(Q)}var ve,ge=(e(ke,ve=he),ke.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},ke.prototype.getVapidFromSWScope=function(n){return d(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:if("string"!=typeof n||0===n.length)throw te.create(q);return[4,this.get(n)];case 1:return[2,(t=e.sent())?t.vapidKey:void 0]}})})},ke.prototype.saveVapidDetails=function(n,r){return d(this,void 0,void 0,function(){var t;return y(this,function(e){if("string"!=typeof n||0===n.length)throw te.create(q);if(null===r||65!==r.length)throw te.create($);return t={swScope:n,vapidKey:r},[2,this.put(t)]})})},ke.prototype.deleteVapidDetails=function(n){return d(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return[4,this.getVapidFromSWScope(n)];case 1:if(!(t=e.sent()))throw te.create(B);return[4,this.delete(n)];case 2:return e.sent(),[2,t]}})})},ke),me="messagingSenderId",we=(_e.prototype.getToken=function(){return d(this,void 0,void 0,function(){var t,n,r,o,i;return y(this,function(e){switch(e.label){case 0:if("denied"===(t=this.getNotificationPermission_()))throw te.create(j);return"granted"!==t?[2,null]:[4,this.getSWRegistration_()];case 1:return n=e.sent(),[4,this.getPublicVapidKey_()];case 2:return r=e.sent(),[4,this.getPushSubscription(n,r)];case 3:return o=e.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(n.scope)];case 4:return(i=e.sent())?[2,this.manageExistingToken(n,o,r,i)]:[2,this.getNewToken(n,o,r)]}})})},_e.prototype.manageExistingToken=function(t,n,r,o){return d(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return function(e,t,n){if(!n.vapidKey||!oe(t.buffer,n.vapidKey.buffer))return!1;var r=e.endpoint===n.endpoint,o=oe(e.getKey("auth"),n.auth),i=oe(e.getKey("p256dh"),n.p256dh);return r&&o&&i}(n,r,o)?Date.now()<o.createTime+6048e5?[2,o.fcmToken]:[2,this.updateToken(t,n,r,o)]:[4,this.deleteTokenFromDB(o.fcmToken)];case 1:return e.sent(),[2,this.getNewToken(t,n,r)]}})})},_e.prototype.updateToken=function(o,i,s,a){return d(this,void 0,void 0,function(){var t,n,r;return y(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,a.fcmToken,a.fcmPushSet,i,s)];case 1:return t=e.sent(),n={swScope:o.scope,vapidKey:s,fcmSenderId:this.messagingSenderId,fcmToken:t,fcmPushSet:a.fcmPushSet,createTime:Date.now(),endpoint:i.endpoint,auth:i.getKey("auth"),p256dh:i.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(n)];case 2:return e.sent(),[4,this.vapidDetailsModel.saveVapidDetails(o.scope,s)];case 3:return e.sent(),[2,t];case 4:return r=e.sent(),[4,this.deleteToken(a.fcmToken)];case 5:throw e.sent(),r;case 6:return[2]}})})},_e.prototype.getNewToken=function(r,o,i){return d(this,void 0,void 0,function(){var t,n;return y(this,function(e){switch(e.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,o,i)];case 1:return t=e.sent(),n={swScope:r.scope,vapidKey:i,fcmSenderId:this.messagingSenderId,fcmToken:t.token,fcmPushSet:t.pushSet,createTime:Date.now(),endpoint:o.endpoint,auth:o.getKey("auth"),p256dh:o.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(n)];case 2:return e.sent(),[4,this.vapidDetailsModel.saveVapidDetails(r.scope,i)];case 3:return e.sent(),[2,t.token]}})})},_e.prototype.deleteToken=function(r){return d(this,void 0,void 0,function(){var t,n;return y(this,function(e){switch(e.label){case 0:return[4,this.deleteTokenFromDB(r)];case 1:return e.sent(),[4,this.getSWRegistration_()];case 2:return(t=e.sent())?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(n=e.sent())return[2,n.unsubscribe()];e.label=4;case 4:return[2,!0]}})})},_e.prototype.deleteTokenFromDB=function(n){return d(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return[4,this.tokenDetailsModel.deleteToken(n)];case 1:return t=e.sent(),[4,this.iidModel.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet)];case 2:return e.sent(),[2]}})})},_e.prototype.getPushSubscription=function(t,n){return t.pushManager.getSubscription().then(function(e){return e||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n})})},_e.prototype.requestPermission=function(){throw te.create(k)},_e.prototype.useServiceWorker=function(e){throw te.create(k)},_e.prototype.usePublicVapidKey=function(e){throw te.create(k)},_e.prototype.onMessage=function(e,t,n){throw te.create(k)},_e.prototype.onTokenRefresh=function(e,t,n){throw te.create(k)},_e.prototype.setBackgroundMessageHandler=function(e){throw te.create(S)},_e.prototype.delete=function(){return d(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}})})},_e.prototype.getNotificationPermission_=function(){return Notification.permission},_e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},_e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},_e.prototype.getIidModel=function(){return this.iidModel},_e);function _e(e){var t=this;if(!e.options[me]||"string"!=typeof e.options[me])throw te.create(T);this.messagingSenderId=e.options[me],this.tokenDetailsModel=new de,this.vapidDetailsModel=new ge,this.iidModel=new se,this.app=e,this.INTERNAL={delete:function(){return t.delete()}}}function ke(){var e=null!==ve&&ve.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}var Se,Te="FCM_MSG",Oe=(e(Pe,Se=we),Pe.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},Pe.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},Pe.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},Pe.prototype.onPush_=function(a){return d(this,void 0,void 0,function(){var t,n,r,o,i,s;return y(this,function(e){switch(e.label){case 0:if(!a.data)return[2];try{t=a.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:return e.sent()?[2,this.sendMessageToWindowClients_(t)]:(n=this.getNotificationData_(t))?(r=n.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return o=e.sent(),i=n.actions,s=Notification.maxActions,i&&s&&i.length>s&&console.warn("This browser only supports "+s+" actions.The remaining actions will not be displayed."),[2,o.showNotification(r,n)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return e.sent(),[2];case 5:return[2]}})})},Pe.prototype.onSubChange_=function(e){return d(this,void 0,void 0,function(){var t,n,r,o;return y(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=e.sent(),[3,3];case 2:throw n=e.sent(),te.create(G,{message:n});case 3:return e.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return e.sent(),[3,8];case 5:return r=e.sent(),[4,this.getTokenDetailsModel().getTokenDetailsFromSWScope(t.scope)];case 6:if(!(o=e.sent()))throw r;return[4,this.deleteToken(o.fcmToken)];case 7:throw e.sent(),r;case 8:return[2]}})})},Pe.prototype.onNotificationClick_=function(i){return d(this,void 0,void 0,function(){var t,n,r,o;return y(this,function(e){switch(e.label){case 0:return i.notification&&i.notification.data&&i.notification.data[Te]?i.action?[2]:(i.stopImmediatePropagation(),i.notification.close(),(t=i.notification.data[Te]).notification&&(n=t.fcmOptions&&t.fcmOptions.link||t.notification.click_action)?[4,this.getWindowClient_(n)]:[2]):[2];case 1:return(r=e.sent())?[3,3]:[4,self.clients.openWindow(n)];case 2:return r=e.sent(),[3,5];case 3:return[4,r.focus()];case 4:r=e.sent(),e.label=5;case 5:return r?(delete t.notification,delete t.fcmOptions,o=Ae(w.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(r,o)]):[2]}})})},Pe.prototype.getNotificationData_=function(e){var t;if(e&&"object"==_typeof(e.notification)){var n=i({},e.notification);return n.data=i({},e.notification.data,((t={})[Te]=e,t)),n}},Pe.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw te.create(V);this.bgMessageHandler=e},Pe.prototype.getWindowClient_=function(i){return d(this,void 0,void 0,function(){var t,n,r,o;return y(this,function(e){switch(e.label){case 0:return t=new URL(i,self.location.href).href,[4,Ee()];case 1:for(n=e.sent(),r=null,o=0;o<n.length;o++)if(new URL(n[o].url,self.location.href).href===t){r=n[o];break}return[2,r]}})})},Pe.prototype.attemptToMessageClient_=function(t,n){return d(this,void 0,void 0,function(){return y(this,function(e){if(!t)throw te.create(z);return t.postMessage(n),[2]})})},Pe.prototype.hasVisibleClients_=function(){return d(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return[4,Ee()];case 1:return[2,e.sent().some(function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")})]}})})},Pe.prototype.sendMessageToWindowClients_=function(o){return d(this,void 0,void 0,function(){var t,n,r=this;return y(this,function(e){switch(e.label){case 0:return[4,Ee()];case 1:return t=e.sent(),n=Ae(w.PUSH_MSG_RECEIVED,o),[4,Promise.all(t.map(function(e){return r.attemptToMessageClient_(e,n)}))];case 2:return e.sent(),[2]}})})},Pe.prototype.getSWRegistration_=function(){return d(this,void 0,void 0,function(){return y(this,function(e){return[2,self.registration]})})},Pe.prototype.getPublicVapidKey_=function(){return d(this,void 0,void 0,function(){var t,n;return y(this,function(e){switch(e.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(t=e.sent()))throw te.create(I);return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return null==(n=e.sent())?[2,ne]:[2,n]}})})},Pe);function Pe(e){var t=Se.call(this,e)||this;return t.bgMessageHandler=null,self.addEventListener("push",function(e){t.onPush(e)}),self.addEventListener("pushsubscriptionchange",function(e){t.onSubChange(e)}),self.addEventListener("notificationclick",function(e){t.onNotificationClick(e)}),t}function Ee(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Ae(e,t){var n;return(n={})[g.TYPE_OF_MSG]=e,n[g.DATA]=t,n}var je,De,Ie=(e(Ne,De=we),Ne.prototype.getToken=function(){return d(this,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=function(){return d(this,void 0,void 0,function(){var t,n;return y(this,function(e){switch(e.label){case 0:if(!(t=document.querySelector('link[rel="manifest"]')))return[2];e.label=1;case 1:return e.trys.push([1,4,,5]),[4,fetch(t.href)];case 2:return[4,e.sent().json()];case 3:return n=e.sent(),[3,5];case 4:return e.sent(),[2];case 5:if(!n||!n.gcm_sender_id)return[2];if("103953800507"!==n.gcm_sender_id)throw te.create(O);return[2]}})})}()),[4,this.manifestCheckPromise];case 1:return e.sent(),[2,De.prototype.getToken.call(this)]}})})},Ne.prototype.requestPermission=function(){return d(this,void 0,void 0,function(){var t;return y(this,function(e){switch(e.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?te.create(E):te.create(P)}})})},Ne.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw te.create(I);if(null!=this.registrationToUse)throw te.create(U);this.registrationToUse=e},Ne.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw te.create(X);if(null!=this.publicVapidKeyToUse)throw te.create("use-public-key-before-get-token");var t=ce(e);if(65!==t.length)throw te.create(Z);this.publicVapidKeyToUse=t},Ne.prototype.onMessage=function(e,t,n){return"function"==typeof e?this.onMessageInternal(e,t,n):this.onMessageInternal(e)},Ne.prototype.onTokenRefresh=function(e,t,n){return"function"==typeof e?this.onTokenRefreshInternal(e,t,n):this.onTokenRefreshInternal(e)},Ne.prototype.waitForRegistrationToActivate_=function(r){var o=r.installing||r.waiting||r.active;return new Promise(function(t,n){o?"activated"!==o.state?"redundant"!==o.state?o.addEventListener("statechange",function e(){if("activated"===o.state)t(r);else{if("redundant"!==o.state)return;n(te.create(N))}o.removeEventListener("statechange",e)}):n(te.create(N)):t(r):n(te.create(H))})},Ne.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch(function(e){throw te.create(D,{browserErrorMessage:e.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return(t.registrationToUse=e).update(),e})}))},Ne.prototype.getPublicVapidKey_=function(){return d(this,void 0,void 0,function(){return y(this,function(e){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,ne]})})},Ne.prototype.setupSWMessageListener_=function(){var r=this;navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[g.TYPE_OF_MSG]){var t=e.data;switch(t[g.TYPE_OF_MSG]){case w.PUSH_MSG_RECEIVED:case w.NOTIFICATION_CLICKED:var n=t[g.DATA];r.messageObserver&&r.messageObserver.next(n)}}},!1)},Ne);function Ne(e){var t=De.call(this,e)||this;return t.registrationToUse=null,t.publicVapidKeyToUse=null,t.manifestCheckPromise=null,t.messageObserver=null,t.tokenRefreshObserver=null,t.onMessageInternal=h(function(e){t.messageObserver=e}),t.onTokenRefreshInternal=h(function(e){t.tokenRefreshObserver=e}),t.setupSWMessageListener_(),t}function xe(){return self&&"ServiceWorkerGlobalScope"in self?"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}je={isSupported:xe},Ce.INTERNAL.registerService("messaging",function(e){if(!xe())throw te.create(A);return self&&"ServiceWorkerGlobalScope"in self?new Oe(e):new Ie(e)},je)}).apply(this,arguments)}catch(e){throw console.error(e),new Error("Cannot instantiate firebase-messaging - be sure to load firebase-app.js first.")}}),wb.firebaseSubscribe=function(){var t,n,r="sentFirebaseMessagingToken",o="lastSubscribedUser",i="https://sapi.wildberries.ru/api/v1/webpush/sub";function s(e){if(!function(e,t){return!!localStorage&&(localStorage.getItem(r)==e&&(0==t.length||localStorage.getItem(o)==t))}(e,n)){var t={token:e,uid:n,locale:wb.settings.domainName.split(".")[1]};$.ajax({url:i,dataType:"json",type:"POST",contentType:"application/json; charset=UTF-8",data:JSON.stringify(t),xhrFields:{withCredentials:!1}}).done(function(){a(e,n)}).fail(function(){console.log("Не удалось подписаться")})}}function a(e,t){localStorage&&(localStorage.trySetItem(r,e||""),localStorage.trySetItem(o,0<t.length?t:-1))}return{init:function(e){e&&$.when(e).then(function(e){n=e.uid||"";try{firebase.initializeApp({messagingSenderId:"847690347422"}),t=firebase.messaging()}catch(e){return}t.requestPermission().then(function(){t.getToken().then(function(e){e?s(e):(console.warn("Не удалось получить токен."),a(!1))}).catch(function(e){console.warn("При получении токена произошла ошибка.",e),a(!1)})}).catch(function(e){console.warn("Не удалось получить разрешение на показ уведомлений.",e)}),t.onTokenRefresh(function(){t.getToken().then(function(e){console.log("Token refreshed."),a(!1),s(e)}).catch(function(e){console.log("Unable to retrieve refreshed token ",e)})}),t.onMessage(function(e){if(e&&e.data&&e.data.payload){var t=JSON.parse(e.data.payload),n=t.title,r=t.body,o=t.icon,i=t.link,s=t.tag,a=t.requireInteraction,c=t.image,u=new Notification(n,{body:r,icon:o,tag:s,requireInteraction:a,image:c});u.onclick=function(e){e.preventDefault(),window.open(i,"_blank"),u.close()}}})})}}}(jQuery);