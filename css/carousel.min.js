void 0===wb.plugins&&(wb.plugins={}),wb.plugins.adaptiveSlider=new function(){var n={speed:200,prevHtml:'<button class="btn-prev"></button>',nextHtml:'<button class="btn-next"></button>',disableArrows:!0,pager:!1,onSliderLoad:function(i){i.parents(".j-slider-gallery").removeClass("cS-hidden")}};function e(l){this._init=function(){var i=$.extend({},n,l.slider);l.circular?(i.loop=!0,"fade"==i.mode?(i.autoWidth=!1,i.item=l.visibleCount):i.autoWidth=!0):(i.loop=!1,i.autoWidth||(i.item=l.visibleCount)),l.lazy&&l.lazy.enable&&e(i);var t=l.container.find(".j-slider-gallery .j-slider").lightSlider(i);this.lightSliderOptions=i,this.lightSliderInstance=t};var e=function(i){function s(i,n){var t=i.filter("["+r+"]");if(t.length){$.each(t,function(i,t){var e=$(t);!function(i){i.attr("src",i.attr(r)),i.removeAttr(r)}(n.filter("["+r+"='"+e.attr(r)+"']"))})}}function e(i,t){var e=i.find(a),n=function(i,t){var e=i.slice(t).slice(0,o),n=t-o+1,s=[];if(n<0){var r=i.slice(0,t);if(s=r,l.circular){var a=i.slice(n,i.length);$.each(a,function(){-1==s.index(this)&&s.push(this)})}}else s=i.slice(n,t);return $.each(s,function(){-1==e.index(this)&&e.push(this)}),e}(e,t);s(n,e)}var t=l.visibleCount?l.visibleCount:3,n=l.slider&&l.slider.slideMove?l.slideMove:1,r=l.lazy.lazyAttr?l.lazy.lazyAttr:"data-jc-original",a=l.lazy.lazySelector?l.lazy.lazySelector:"img",o=t+n;i.onSliderLoad=function(i){e(i,0),i.parents(".j-slider-gallery").removeClass("cS-hidden")},i.onBeforeSlide=function(i,t){e(i,t)}}}this.pluginInit=function(i){if(0!=i.container.length){var t=new e(i);return t._init(),wb.sliders||(wb.sliders=[]),wb.sliders.push(t.lightSliderInstance),t}}},wb.plugins.adaptiveCarousel=new function(){var l={responsive:!0,swipeClick:!0,swipeThresholds:{x:20,kMinSwipe:.25}};function e(o){this._init=function(){this.CarouselLiteOptions=$.extend({},l,o.carousel);var i=o.container.find("li").length,t=(o.itemsCount=i)<=o.minResolutionVisibleCount,e=o.adaptive&&i<=o.maxResolutionVisibleCount;if(t)o.container.addClass(o.adaptiveCssClass);else{this.CarouselLiteOptions.btnNext=o.container.find(".j-next"),this.CarouselLiteOptions.btnPrev=o.container.find(".j-prev"),o.circular?this.CarouselLiteOptions.circular=!0:this.CarouselLiteOptions.circular=!1;var n=this;e&&(this.CarouselLiteOptions.onResize=function(i){n._updateCosmetics(i.length)});var s=o.container.find(".j-adaptive-carousel");if(s.jCarouselLite(this.CarouselLiteOptions),this.opts=o,e){var r=parseInt(s.attr("data-visible"),10),a=Math.min(r,o.itemsCount);this._updateCosmetics(a)}else this.opts.container.removeClass(this.opts.adaptiveCssClass)}},this._updateCosmetics=function(i){i==Math.min(this.opts.maxResolutionVisibleCount,this.opts.itemsCount)?this.opts.container.addClass(this.opts.adaptiveCssClass):this.opts.container.removeClass(this.opts.adaptiveCssClass)}}this.pluginInit=function(i){var t=new e(i);return t._init(),t}},wb.plugins.verticalSlider=new function(){function e(i){this._init=function(){this.opts=i,this._initCarousel(i)},this._initCarousel=function(i){var t=".j-slider-item",e=(i.container.find(".j-slider-gallery").parent().height(),i.container.find(".j-slider")),n=parseInt(e.css("padding-top"),10),s=parseInt(e.css("padding-bottom"),10),r=i.availableHeight;r-=n,r-=s;var a=e.find(t).length,o=e.find(t+":first"),l=parseInt(o.css("height"),10),u=parseInt(o.css("margin-bottom"),10),c={availableHeight:r,itemsCount:a,itemHeight:l,itemMargin:u},d=this._calculateHowMuchItemsFit(c),p=a>d.items,h={container:i.container,visibleCount:d.items,slider:{autoWidth:!1,slideMargin:u,cssEasing:"cubic-bezier(0.25, 0.1, 0.25, 1)",speed:400,vertical:!0,verticalHeight:d.verticalHeight,onSliderLoad:function(i){p?i.parents(".lSSlideOuter.vertical").addClass("arrow-space"):i.parents(".lSSlideOuter.vertical").removeClass("arrow-space"),i.parents(".j-slider-gallery").removeClass("cS-hidden")}}},f=wb.carousel.initSlider(h);this.lightSliderOptions=f.lightSliderOptions,this.lightSliderInstance=f.lightSliderInstance},this._calculateHowMuchItemsFit=function(i){for(var t=0,e=0,n=0;n<i.itemsCount;n++)if(t++,(e+=i.itemHeight+i.itemMargin)>=i.availableHeight){var s=i.availableHeight-(e-i.itemMargin);0==s?e-=i.itemMargin:0<s?(e-=i.itemMargin,e-=s):(e-=i.itemHeight+i.itemMargin,t--,e-=i.itemMargin);break}return n===i.itemsCount&&(e-=i.itemMargin),{items:t,verticalHeight:e}}}this.pluginInit=function(i){var t=new e(i);return t._init(),t}},wb.plugins.goodsAjaxCarousel=new function(){function e(t){this._init=function(){this.opts=t,this.opts.useListCarousels||(this.opts.visibleCount=this.opts.container.data("visible")||0,this.opts.goodsUrl=this.opts.container.data("goods-url"),this.opts.title=this.opts.container.data("title"),this.opts.seeAllUrl=this.opts.container.data("link-all"),this.opts.targetUrl=this.opts.container.data("target-url")),$.templates({newNestTmpl:"#newNestTmpl"}),this.opts.goodsTmpl=$.render.newNestTmpl,this._downloadGoods()},this._downloadGoods=function(){var r=this;$.ajax({type:"GET",dataType:"json",cache:!0,url:this.opts.useListCarousels?this.opts.carouselsModelUrl:this.opts.goodsUrl,error:function(i){},success:function(i){$.processResponse(i,function(i){if(r.opts.useListCarousels){if(0<i.carousels.length){var s=$.grep(i.carousels,function(i,t){return i.goods.length>=r.opts.visibleCount});$.each(t.containers,function(i,t){var e=$(t),n=s[i];n&&r._renderCarousel(n.goods,e,n.firstTitle,n.targetURL,n.showAllURL)})}}else i&&i.goods&&i.goods.length>=r.opts.visibleCount&&r._renderCarousel(i.goods,r.opts.container,r.opts.title,r.opts.targetUrl)},function(){})}})},this._renderCarousel=function(t,e,n,s,r){var a=this;wb.xnm.fillPrice(t,function(){var i=$.extend({},a.opts,{goods:t,title:n,targetUrl:s,seeAllUrl:r});e.html(a.opts.goodsTmpl(i)),a._initCarousel(e)})},this._initCarousel=function(i){var t={container:i,slider:{autoWidth:!0,slideMargin:30}};wb.carousel.initSlider(t)}}this.pluginInit=function(i){if((i.useListCarousels||0!=i.container.length)&&(!i.useListCarousels||0!=i.containers.length)){var t=new e(i);return t._init(),t}}},wb.namespace("carousel",function(){return{initVerticalSlider:function(i){return wb.plugins.verticalSlider.pluginInit(i)},initAjaxCarousel:function(i){return wb.plugins.goodsAjaxCarousel.pluginInit(i)},initSlider:function(i){return wb.plugins.adaptiveSlider.pluginInit(i)},initCarousel:function(i){return wb.plugins.adaptiveCarousel.pluginInit(i)},renderProductPrices:function(i){wb.helpers.renderPricesByNmIds({$container:$(".j-products-container"),tmplSl:"#newNestPriceTmpl",productSl:".j-product-item",priceBlockSl:".j-price-block",nmIdData:"nmId"})},lazyLoad:(a={circular:!0,sideElementsCount:1,visibleElementsCount:1},{start:function(i,t){var e=$.extend({},a,t),n=function(i,t){var e,n=("visible by client"===t.visibleElementsCount?o(i):t.visibleElementsCount)+(t.circular?(e=i.find("li.jc-active").index()-t.sideElementsCount,2*t.sideElementsCount):(e=0,t.sideElementsCount));return i.find("li").slice(e).slice(0,n).find("img")}(i,e);r(i,e,n)},next:function(i,t,e){var n=$.extend({},a,e),s=function(i,t,e){var n,s,r="visible by client"===e.visibleElementsCount?o(t):e.visibleElementsCount,a=t.find("li.jc-active").index();if(e.circular)s=i?(n=a,r+e.sideElementsCount):(n=a-e.sideElementsCount,r);else{if(!i)return;n=a,s=2*r}return t.find("li").slice(n).slice(0,s).find("img").filter("[data-original]")}(i,t,n);r(t,n,s)}})};function o(i){var t=i.find("ul").parent(),e=parseInt(t.width(),10),n=t.find("li").first(),s=parseInt(n.outerWidth(!0),10);return Math.ceil(e/s)}function r(i,n,t){if(void 0!==t){var s=i.find("img");$.each(t,function(i,t){if(n.circular)var e=s.filter("[data-original='"+$(t).data("original")+"']");else e=$(t);e.attr("src",$(t).data("original")).removeAttr("data-original")})}}var a}()),wb.initCarousel=function(i,t){if(i&&0<i.length){var e={btnNext:i.find(".j-next-arrow"),btnPrev:i.find(".j-prev-arrow"),visible:1,timeout:7e3,speed:1e3,auto:!0,fade:!0},n=$.extend({},e,t);i.jCarouselLite({btnNext:n.btnNext,btnPrev:n.btnPrev,btnGo:i.find(".banner-pager button"),visible:n.visible,responsive:!0,timeout:n.timeout,speed:n.speed,swipeSpeed:500,auto:n.auto,lazyImg:!0,crutchWidth:!0,doNotRecalcVisible:!0,fade:n.fade,preventTouchWindowScroll:!1,visibleClass:"current",swipeThresholds:{x:80,y:200,time:220,kMinSwipe:.15},beforeStart:n.beforeStart,afterSetActive:n.afterSetActive,afterEnd:n.afterEnd,imgSelector:n.imgSelector,lazyImgAttr:n.lazyImgAttr})}};